<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>현규의 웹 서비스 세상 *^^*</title>
<!-- Custom styles for this template-->
<link th:href="@{/css/sb-admin.css}" rel="stylesheet" type="text/css"/>

</head>
<body class="bg-dark">
<div class="container">
    <div class="card card-register mx-auto mt-5">
        <div class="card-header">Register an Account</div>
        <div class="card-body">
            <!--            <form>-->
            <div class="form-group">
                <div class="form-row">
                    <div class="col-md-6">
                        <div class="form-label-group">
                            <input type="text" id="adminId" class="form-control" placeholder="First name" required="required" autofocus="autofocus">
                            <label for="adminId">아이디</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-label-group">
                            <input type="text" id="name" class="form-control" placeholder="Last name" required="required">
                            <label for="name">이름</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="form-row">
                    <div class="col-md-6">
                        <div class="form-label-group">
                            <input type="password" id="adminPassword" class="form-control" placeholder="Password" required="required">
                            <label for="adminPassword">비밀번호</label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-label-group">
                            <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm password" required="required">
                            <label for="confirmPassword">비밀번호 확인</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="form-label-group">
                    <input type="text" id="tellNumber" class="form-control" placeholder="연락처" required="required">
                    <label for="name">연락처</label>
                </div>
            </div>
            <button class="btn btn-primary btn-block" id="joinAdmin">가입하기</button>
<!--            <button class="btn btn-primary btn-block" id="joinUser">사용자로 가입</button>-->
            <!--            </form>-->
            <div class="text-center">
                <a class="d-block small mt-3" href="/">Login Page</a>
            </div>
        </div>
    </div>
</div>
<script>
    //TODO 한 폼에서 따로 가입 로직 구현되게 해보기
    document.getElementById('joinAdmin').addEventListener('click', e => signup(admin));
    document.getElementById('joinUser').addEventListener('click', e => signup(user));
    let who;
    async function signup(who) {
        // let x = document.querySelector('body > div > div > div.col-sm-8.text-left');
        console.log("가입하기 gogo");
        let id = document.getElementById(`${who}Id`).value;
        let password =  document.getElementById(`${who}Password`).value;
        let confirmPassword =  document.getElementById('confirmPassword').value;
        let name =  document.getElementById('name').value;
        let tellNumber = document.getElementById('tellNumber').value;
        try {
            let res = await fetch(`/api/${who}` , {
                method:'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Charset': 'UTF-8'
                },
                body: JSON.stringify({
                    Id,
                    Password,
                    confirmPassword,
                    name,
                    tellNumber,
                    // bank: document.getElementById('bank').value
                })
            });
            if(adminId === "" || adminPassword === "" || confirmPassword === "" || name === "" || tellNumber ===""){
                alert("양식을 전부 입력 해주세요!")
            }else {
                if(adminPassword != confirmPassword){
                    alert("비밀번호를 확인 해주세요.")
                }else{
                    if(res.ok) document.location.href="/";
                    alert("가입이 완료되었습니다!");
                }
            }
        } catch (e) {
        }
    }
</script>
</body>
</html>